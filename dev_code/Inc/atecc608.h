/*
 * atecc608.h
 *
 *  Created on: Aug 16, 2022
 *      Author: Tom
 */

#ifndef INC_ATECC608_H_
#define INC_ATECC608_H_

#include "stdint.h"

#define AT608_DEVICE_ADDRESS		0x35

// ext rng error codes
#define NOTHXKGB					-99
#define AT608_ERROR					-1
#define AT608_NOT_DETECTED 			-2
#define AT608_RNG_IN_TEST_MODE 		-3
#define AT608_RNG_TEST_FAILED 		-4
#define AT608_SELF_TEST_FAILED 		-5

// device commands
#define AT608_CMD_COUNTER			0x24
#define AT608_CMD_INFO				0x30
#define AT608_CMD_LOCK				0x17
#define AT608_CMD_NONCE				0x16
#define AT608_CMD_RANDOM		0x1B
#define AT608_CMD_READ			0x02
#define AT608_CMD_SELFTEST		0x77
#define AT608_CMD_SHA			0x47
#define AT608_CMD_UPDATEEXTRA	0X02
#define AT608_CMD_WRITE			0X12

#define AT608_DATA_ZONE_4BYTE	0x02
#define AT608_DATA_ZONE_32BYTE	0x82

// Defines to simplify their weird addressing system
// Important: Each of these addresses is for a 32 byte block
// if you want to address 4byte e.g for AES key setting then use the offset in the LSB [2:0]

// datazone 0-7
//  								   Byte1[15:8]       Byte0[7:0]
//                           		NA[15:9] Block[8]  NA[7] Slot[6:3] Offset[2:0]
#define AT608_SLOT0_BLOCK0_H 0x00	 //0000 0000  			0 0000 000
#define AT608_SLOT0_BLOCK0_L 0x00
#define AT608_SLOT0_BLOCK1_H 0x01	 //0000 0001  			0 0000 000
#define AT608_SLOT0_BLOCK1_L 0x00

#define AT608_SLOT1_BLOCK0_H 0x00	 //0000 0000  			0 0001 000
#define AT608_SLOT1_BLOCK0_L 0x08
#define AT608_SLOT1_BLOCK1_H 0x01	 //0000 0001  			0 0001 000
#define AT608_SLOT1_BLOCK1_L 0x08

#define AT608_SLOT2_BLOCK0_H 0x00	 //0000 0000 			0 0010 000
#define AT608_SLOT2_BLOCK0_L 0x10
#define AT608_SLOT2_BLOCK1_H 0x01	 //0000 0001 			0 0010 000
#define AT608_SLOT2_BLOCK1_L 0x10

#define AT608_SLOT3_BLOCK0_H 0x00	 //0000 0000 			0 0011 000
#define AT608_SLOT3_BLOCK0_L 0x18
#define AT608_SLOT3_BLOCK1_H 0x01	 //0000 0001 			0 0011 000
#define AT608_SLOT3_BLOCK1_L 0x18

#define AT608_SLOT4_BLOCK0_H 0x00	 //0000 0000 			0 0100 000
#define AT608_SLOT4_BLOCK0_L 0x20
#define AT608_SLOT4_BLOCK1_H 0x01	 //0000 0001 			0 0100 000
#define AT608_SLOT4_BLOCK1_L 0x20

#define AT608_SLOT5_BLOCK0_H 0x00	 //0000 0000 			0 0101 000
#define AT608_SLOT5_BLOCK0_L 0x28
#define AT608_SLOT5_BLOCK1_H 0x01	 //0000 0001 			0 0101 000
#define AT608_SLOT5_BLOCK1_L 0x28

#define AT608_SLOT6_BLOCK0_H 0x00	 //0000 0000			0 0110 000
#define AT608_SLOT6_BLOCK0_L 0x30
#define AT608_SLOT6_BLOCK1_H 0x01	 //0000 0001			0 0110 000
#define AT608_SLOT6_BLOCK1_L 0x30

#define AT608_SLOT7_BLOCK0_H 0x00	 //0000 0000 			0 0111 000
#define AT608_SLOT7_BLOCK0_L 0x38
#define AT608_SLOT7_BLOCK1_H 0x01	 //0000 0001 			0 0111 000
#define AT608_SLOT7_BLOCK1_L 0x38

// datazone 8
//   									  Byte1[15:8]       Byte0[7:0]
// 									NA[15:12] Block[11:8]  NA[7] Slot[6:3] Offset[2:0]

#define AT608_SLOT8_BLOCK0_H	0x00	 //0000 0000				0 1000 000
#define AT608_SLOT8_BLOCK0_L	0x40
#define AT608_SLOT8_BLOCK1_H	0x01	 //0000 0001 				0 1000 000
#define AT608_SLOT8_BLOCK1_L	0x40
#define AT608_SLOT8_BLOCK2_H	0x02	 //0000 0010 				0 1000 000
#define AT608_SLOT8_BLOCK2_L	0x40
#define AT608_SLOT8_BLOCK3_H	0x03	 //0000 0011 				0 1000 000
#define AT608_SLOT8_BLOCK3_L	0x40
#define AT608_SLOT8_BLOCK4_H	0x04	 //0000 0100 				0 1000 000
#define AT608_SLOT8_BLOCK4_L	0x40
#define AT608_SLOT8_BLOCK5_H	0x05	 //0000 0101 				0 1000 000
#define AT608_SLOT8_BLOCK5_L	0x40
#define AT608_SLOT8_BLOCK6_H	0x06	 //0000 0110 				0 1000 000
#define AT608_SLOT8_BLOCK6_L	0x40
#define AT608_SLOT8_BLOCK7_H	0x07	 //0000 0111 				0 1000 000
#define AT608_SLOT8_BLOCK7_L	0x40
#define AT608_SLOT8_BLOCK8_H	0x08	 //0000 1000 				0 1000 000
#define AT608_SLOT8_BLOCK8_L	0x40
#define AT608_SLOT8_BLOCK9_H	0x09	 //.... .... 				0 1000 000
#define AT608_SLOT8_BLOCK9_L	0x40
#define AT608_SLOT8_BLOCK10_H	0x0A	 //.... .... 				0 1000 000
#define AT608_SLOT8_BLOCK10_L	0x40
#define AT608_SLOT8_BLOCK11_H	0x0B	 //.... .... 				0 1000 000
#define AT608_SLOT8_BLOCK11_L	0x40
#define AT608_SLOT8_BLOCK12_H	0x0C	 //.... .... 				0 1000 000
#define AT608_SLOT8_BLOCK12_L	0x40
// shortcut
#define AT608_SLOT8_BLOCKX_H	0x00 //+blockno
#define AT608_SLOT8_BLOCKX_L	0x40


// datazone 9-15
//   									  Byte1[15:8]       Byte0[7:0]
// 									NA[15:10] Block[9:8]  NA[7] Slot[6:3] Offset[2:0]
#define AT608_SLOT9_BLOCK0_H 0x00	 // 0x00 				0 1001 000
#define AT608_SLOT9_BLOCK0_L 0x48 // i.e 0x09 with 3 trailing 0s
#define AT608_SLOT9_BLOCK1_H 0x01	 // 0x01
#define AT608_SLOT9_BLOCK1_L 0x48
#define AT608_SLOT9_BLOCK2_H 0x02 	 // 0x02
#define AT608_SLOT9_BLOCK2_H 0x48

#define AT608_SLOT10_BLOCK0_H 0x00	 // 0x00 				0 1010 000
#define AT608_SLOT10_BLOCK0_L 0x50
#define AT608_SLOT10_BLOCK1_H 0x01	 // 0x01
#define AT608_SLOT10_BLOCK1_L 0x50
#define AT608_SLOT10_BLOCK2_H 0x02 	 // 0x02
#define AT608_SLOT10_BLOCK2_H 0x50

#define AT608_SLOT11_BLOCK0_H 0x00	 // 0x00 				0 1011 000
#define AT608_SLOT11_BLOCK0_L 0x58
#define AT608_SLOT11_BLOCK1_H 0x01	 // 0x01
#define AT608_SLOT11_BLOCK1_L 0x58
#define AT608_SLOT11_BLOCK2_H 0x02 	 // 0x02
#define AT608_SLOT11_BLOCK2_H 0x58

#define AT608_SLOT12_BLOCK0_H 0x00	 // 0x00 				0 1100 000
#define AT608_SLOT12_BLOCK0_L 0x60
#define AT608_SLOT12_BLOCK1_H 0x01	 // 0x01
#define AT608_SLOT12_BLOCK1_L 0x60
#define AT608_SLOT12_BLOCK2_H 0x02 	 // 0x02
#define AT608_SLOT12_BLOCK2_H 0x60

#define AT608_SLOT13_BLOCK0_H 0x00	 // 0x00 				0 1101 000
#define AT608_SLOT13_BLOCK0_L 0x68
#define AT608_SLOT13_BLOCK1_H 0x01	 // 0x01
#define AT608_SLOT13_BLOCK1_L 0x68
#define AT608_SLOT13_BLOCK2_H 0x02 	 // 0x02
#define AT608_SLOT13_BLOCK2_H 0x68

#define AT608_SLOT14_BLOCK0_H 0x00	 // 0x00 				0 1110 000
#define AT608_SLOT14_BLOCK0_L 0x70
#define AT608_SLOT14_BLOCK1_H 0x01	 // 0x01
#define AT608_SLOT14_BLOCK1_L 0x70
#define AT608_SLOT14_BLOCK2_H 0x02 	 // 0x02
#define AT608_SLOT14_BLOCK2_H 0x70

#define AT608_SLOT15_BLOCK0_H 0x00	 // 0x00 				0 1111 000
#define AT608_SLOT15_BLOCK0_L 0x78
#define AT608_SLOT15_BLOCK1_H 0x01	 // 0x01
#define AT608_SLOT15_BLOCK1_L 0x78
#define AT608_SLOT15_BLOCK2_H 0x02 	 // 0x02
#define AT608_SLOT15_BLOCK2_H 0x78


// command execution times
#define AT608_EXEC_TIME_MS_AES			1
#define AT608_EXEC_TIME_MS_LOCK			15
#define AT608_EXEC_TIME_MS_MAC			7
#define AT608_EXEC_TIME_MS_NONCE		17
#define AT608_EXEC_TIME_MS_RANDOM		15
#define AT608_EXEC_TIME_MS_SHA			15



#endif /* INC_ATECC608_H_ */
